sequenceDiagram
    participant Client
    participant Controller as TransactionController
    participant FFA as FeatureFlagAspect
    participant MA as MetricsAspect
    participant Service as CreateTransactionService
    participant Adapter as TransactionRepositoryAdapter
    participant DB as H2 Database
    participant Domain as Transaction Domain
    
    Client->>Controller: POST /transactions<br/>{amount: 100.00, description: "Office supplies", type: "EXPENSE"}
    
    Note over Controller: Feature Flag Check
    Controller->>FFA: Check "create-transaction" flag
    FFA-->>Controller: ✓ Feature enabled
    
    Note over Controller: Metrics Tracking
    Controller->>MA: Track "transactions.created"
    MA-->>Controller: ✓ Metric recorded
    
    Note over Controller: DTO to Domain Mapping
    Controller->>Domain: new Transaction(amount, description, type)
    Domain->>Domain: Validate amount > 0
    Domain->>Domain: Validate description not empty
    Domain->>Domain: Generate UUID
    Domain->>Domain: Set current timestamp
    Domain-->>Controller: ✓ Transaction created
    
    Note over Controller: Business Logic
    Controller->>Service: create(transaction)
    Service->>Adapter: save(transaction)
    
    Note over Adapter: Domain to Entity Mapping
    Adapter->>Adapter: mapToEntity(transaction)
    Adapter->>DB: save(TransactionEntity)
    DB-->>Adapter: ✓ Entity saved
    
    Note over Adapter: Entity to Domain Mapping
    Adapter->>Adapter: mapToDomain(savedEntity)
    Adapter-->>Service: Transaction domain object
    Service-->>Controller: Transaction
    Controller-->>Client: HTTP 200<br/>{id: "uuid", amount: 100.00, description: "Office supplies", type: "EXPENSE", date: "2024-01-15T10:30:00"}
